## ⚠️ 重要提示

**自v1.2.5.0 到 v1.3.5.0版本起，SecRandom 已停止对 Windows 7 和 x86 系统的官方支持。建议使用 Windows 10 x64 或更高版本系统以获得最佳体验。**

**注意：在 v1.3.5.0 版本之后，SecRandom 将会重新支持 Windows 7 及以上系统的 x86 和 x64 架构。**

**如急需在 Windows 7 或 x86 系统上使用本工具，可使用仓库根目录下的 requirements-windows-win7_x64_x86.txt 文件自行打包适配。**

---

## 📢 插件上架通知

**🎉 好消息！SecRandom 的 ClassIsland 和 Class-Widgets 插件现已正式上架到对应平台的插件广场！**

- **ClassIsland 插件**：可在 ClassIsland 插件市场中找到 "SecRandom" 插件，点击下载安装
- **Class-Widgets 插件**：可在 Class-Widgets 插件广场中找到 "SecRandom" 插件，点击下载安装

**🆕 ClassIsland 插件支持课堂功能：**
- **上课时间获取**：自动获取当前课程时间信息
- **课间禁用功能**：课间休息时段自动禁用抽取功能，避免干扰正常教学秩序
- **上课前自动清理**：新课程开始前自动清除已抽取记录，确保每节课都有全新的抽取体验

安装插件后，即可在相应平台中使用 SecRandom 的闪抽/即抽结果显示功能，体验更加便捷的随机抽取服务！

---

## 🚀 主要更新

- 新增 **点名界面名单修改按钮显示控制选项**
- 新增 **闪抽/即抽结果显示方式配置**，上架 ClassIsland 和 Class-Widgets 插件
- 新增 ClassIsland、Class-Widgets 显示时长配置，默认 3 秒
- 新增 **ClassIsland 插件课堂功能**，支持上课时间获取、课间禁用和上课前自动清理功能
- 新增 **名单 TXT 格式导出功能**，支持单独导出学生名单或奖品名单
- 新增 **学生名单中"学生是否在班"的设置功能**，添加"在班级"勾选框，可直接标记学生的在班状态
- 新增 重置浮窗位置功能按钮，将浮窗位置重置为屏幕中央

---

## 💡 功能优化

- 优化 启动页面样式，支持主题自适应
- 优化 默认字体设置为 HarmonyOS Sans SC
- 优化 即抽界面布局，将名单、小组、性别配置移至独立界面
- 优化 日志和代码注释，移除冗余信息
- 优化 个性设置界面加载性能
- 优化 动画间隔范围为 1ms-2000ms（注：**<20ms 可能导致标签异常**）
- 优化 启动页面采用异步加载机制
- 优化 软件主题色默认值逻辑，自动采用系统主题色
- 优化 **历史记录界面，采用分段加载方式，显著提升使用体验**
- 优化 日志输出，简化调试信息，调整合理的日志级别（DEBUG 级别用于开发调试，INFO 级别用于用户操作记录）
- 优化 导出诊断数据功能，用户可选择导出位置
- 优化 避免加载配置文件后不必要的保存操作
- 优化 默认开启跟随点名设置
- 优化 **大幅度提升软件页面的加载速度**
- 优化 **闪抽/即抽按钮交互逻辑**，可设置抽取过程中可通过点击按钮关闭抽取窗口
- 优化 浮窗初始显示位置，确保不会超过屏幕大小，提升用户体验
- 优化 将闪抽窗口的自动关闭时间设置与开关功能整合至闪抽/即抽设置页面，提升设置管理的便捷性
- 优化 闪抽窗口提示文本：根据"点击后关闭抽取窗口"功能状态显示不同提示，启用时显示"抽取结束，请手动关闭或再次点击抽取按钮"，禁用时显示"抽取结束，请手动关闭该窗口"
- 优化 **设置字体后即刻应用字体，无需重启软件**

---

## 🐛 修复问题

- 修复 **未安装字体时，字体选择器中缺少 HarmonyOS Sans SC、汉仪文黑-85W 选项的问题**
- 修复 **抽取过程和结果未应用设置字体的问题**
- 修复 **抽取结束后抽取次数未正确重置的问题**
- 修复 **闪抽/即抽名单与主界面点名名单隔离失效的问题**
- 修复 清理临时抽取记录时错误清理隔离名单的问题
- 修复 重启清除模式下重启后剩余人数未刷新的问题
- 修复 历史记录中多个位置（学生/奖品时间排序、单个奖品记录）的加载错误
- 修复 导出诊断数据无法打开导出文件的问题
- 修复 URL显示无法找到主窗口实例的问题
- 修复 **animation_mode 值在同步时可能不一致的问题**，确保即使新旧值相同但功能指向不同时也能正确同步
- 修复 **click_timer 为 None 时导致的 AttributeError 错误问题**

---

## 🔧 其它变更

- 移除 即抽界面管理功能
- 更换 SecRandom 软件图标（感谢 aiwb 提供图标支持）
- 移除 SecRandom 内置的插件功能

---

💝 **感谢所有贡献者为 SecRandom 项目付出的努力！** 

---
<details>
<summary>V1.3-Beta 历史版本</summary>

### v1.2.9999-beta

#### 🚀 主要更新

- 新增 可在上课前预设时间自动清除点名、抽奖页面内的学生名称标签和奖品名称标签
- 新增 可设置隔离点名、闪抽/即抽 已抽取记录
- 新增 可配置窗口背景（主窗口、闪抽/即抽窗口、设置窗口）颜色
- 新增 可配置 闪抽 默认选择名单
- 新增 可配置托盘选项显隐

#### 💡 功能优化

- 无

#### 🐛 修复问题

- 修复 调整最大不重复抽取次数后，剩余人数显示错误问题
- 修复 无法在上课前预设时间清除已抽取记录的问题
- 修复 设置 “抽取管理设置” 中，修改最后的设置组名称为 “闪抽/即抽窗口管理”
- 修复 闪抽/即抽设置中动画模式同步逻辑问题：将 “手动停止动画”（原值 0）和 “自动播放完整动画”（原值 1）统一调整为 “自动播放完整动画”（新值 0）；将 “直接显示结果”（原值 2）调整为 “直接显示结果”（新值 1）
- 修复 闪抽/即抽窗口 不会自动关闭的问题
- 修复 结果音乐不播放的问题

#### 🔧 其它变更

- 无

### v1.2.8.7-beta

#### 🚀 主要更新

- 新增 最大抽取次数设置，可设置一轮中的每个人的最大抽取次数(0为重复抽取)
- 新增 抽取操作完成后，临时抽取记录的自动清除时间设置功能
- 新增 可设置点名/抽奖/即抽界面的所有功能的显隐
- 新增 可以单独设置闪抽/即抽设置，并且可以跟随点名设置
- 新增 可设置下课打开主界面的任何形式都需要输入密码（需要在设置中开启密码保护）
- 新增 可设置上课前的1800秒范围内清除临时抽取记录

#### 💡 功能优化

- 优化 背景图片开关改为默认关闭
- 优化 (更新/URL)通知弹窗按钮颜色根据主题色颜色自动切换
- 优化 闪抽窗口宽度新增根据字体数量进行计算
- 优化 将"抽人"二字改为"点名"
- 优化 将"抽取模式"设置文本改为"清理临时记录"
- 优化 将浮窗相关的设置迁移到"自定义设置"中
- 优化 默认将启动页面设置为禁用

#### 🐛 修复问题

- 修复 无法显示URL的提醒/同意/需验证的弹窗
- 修复 修复只根据人数动态计算宽度的问题
- 修复 打开抽奖音乐文件夹的路径错误问题
- 修复 URL 仅在打开设置页面 > 更多设置 > 基础设置时才会注册的问题

#### 🔧 其它变更

- 无

### v1.2.6.22-beta

#### 🚀 主要更新

- 新增 个性设置页面
- 新增 固定 URL 配置功能，可设置是否启用、是否提醒以及是否需要安全验证
- 新增 可配置需经过安全验证的固定 URL
- 新增 背景图片设置功能，主页面、设置界面和闪抽界面均可独立设置背景图片
- 新增 软件主题色设置功能
- 新增 软件字体设置功能
- 新增 侧边栏的管理页面(将原本的抽人、抽奖、单词PK、设置页面合并到侧边栏管理页面)
- 新增 可在侧边栏管理页面配置设置界面的侧边栏位置和显示状态

#### 💡 功能优化

- 优化 抽取记录清空功能，无需打开页面即可清空当前抽取记录的 URL
- 优化 设置界面控件，将下拉框、按钮等控件改为自适应宽度
- 优化 软件图标，改用字体库，支持更多字体图标
- 优化 随机颜色的生成算法，避免生成的颜色过于弱化

#### 🐛 修复问题

- 修复 日志文件路径问题
- 修复 点击展开收纳浮窗后，再次点击收起时浮窗未恢复到原始位置的问题
- 修复 因未设置名单等信息导致闪抽窗口无法抽取的问题
- 修复 随机颜色失效的问题

#### 🔧 其它变更

- 无

</details>
